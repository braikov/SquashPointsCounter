@using System.Globalization
@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer Localizer
@{
    var path = Context.Request.Path.Value ?? "/";
    var isBg = path.StartsWith("/bg", StringComparison.OrdinalIgnoreCase);
    var targetPrefix = isBg ? "/en" : "/bg";
    var trimmedPath = path.StartsWith("/bg", StringComparison.OrdinalIgnoreCase) || path.StartsWith("/en", StringComparison.OrdinalIgnoreCase)
        ? path.Substring(3)
        : path;
    var switchUrl = string.IsNullOrEmpty(trimmedPath) ? targetPrefix : targetPrefix + trimmedPath;

    var baseModel = Model as Squash.Web.Areas.Public.Models.PageViewModel;
    var pageTitle = baseModel?.Title;
    var siteTitle = Localizer["SiteTitle"].Value;
    var fullTitle = string.IsNullOrWhiteSpace(pageTitle) ? siteTitle : $"{pageTitle} | {siteTitle}";
    var metaDescription = baseModel?.MetaDescription;
    var canonicalUrl = baseModel?.CanonicalUrl;
}

<!DOCTYPE html>
<html lang="@CultureInfo.CurrentUICulture.TwoLetterISOLanguageName">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>@fullTitle</title>
    @if (!string.IsNullOrWhiteSpace(metaDescription))
    {
        <meta name="description" content="@metaDescription" />
    }
    @if (!string.IsNullOrWhiteSpace(canonicalUrl))
    {
        <link rel="canonical" href="@canonicalUrl" />
    }
</head>
<body>
    <header>
        <nav>
            <a href="@switchUrl">
                @(isBg ? Localizer["SwitchToEn"] : Localizer["SwitchToBg"])
            </a>
        </nav>
    </header>
    <main>
        @RenderBody()
    </main>
</body>
</html>
